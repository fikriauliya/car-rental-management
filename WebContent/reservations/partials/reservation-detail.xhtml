<div class="row">
  <div class="col-md-12">
    <h4>
      Reservation Details #{{reservations[0].groupId}}
      <span class="label label-danger" ng-if="!reservations[0].paid">Unpaid</span>
      <span class="label label-success" ng-if="reservations[0].paid">Paid</span>

      <span class="label label-danger" ng-if="totalOverdueFee > 0 && !reservations[0].overduePaid">Overdue Unpaid</span>
      <span class="label label-success" ng-if="totalOverdueFee > 0 && reservations[0].overduePaid">Overdue Paid</span>

      <span class="label label-primary" ng-if="reservations[0].status == 'SCHEDULED'">{{reservations[0].status}}</span>
      <span class="label label-danger" ng-if="reservations[0].status == 'CANCELED'">{{reservations[0].status}}</span>
      <span class="label label-success" ng-if="reservations[0].status == 'STARTED'">{{reservations[0].status}}</span>
      <span class="label label-warning" ng-if="reservations[0].status == 'FINISHED'">{{reservations[0].status}}</span>
    </h4>
    <div ng-if="isAdmin">
      <button class="btn btn-sm btn-success" ng-click="startRental()" ng-if="reservations[0].status == 'SCHEDULED'">
        <span class="glyphicon glyphicon-play"/>
        Start rental
      </button>
      <button class="btn btn-sm btn-warning" ng-click="finishRental()" ng-if="reservations[0].status == 'STARTED'">
        <span class="glyphicon glyphicon-stop"/>
        Finish rental
      </button>
      <button class="btn btn-sm btn-danger" ng-click="cancelRental()" ng-if="reservations[0].status == 'SCHEDULED'">
        <span class="glyphicon glyphicon-remove-circle"/>
        Cancel reservation
      </button>
      <button class="btn btn-sm btn-primary" ng-click="markPaid()" ng-if="!reservations[0].paid && reservations[0].status != 'CANCELED'">
        <span class="glyphicon glyphicon-ok"/>
        Mark as paid
      </button>
      <button class="btn btn-sm btn-primary" ng-click="markUnpaid()" ng-if="reservations[0].paid">
        <span class="glyphicon glyphicon-remove"/>
        Mark as unpaid
      </button>

      <span ng-if="totalOverdueFee > 0">
        |
        <b ng-style="{color:reservations[0].overduePaid?'blue':'red'}">
          Overdue: {{totalOverdueFee}}
        </b>
        <button class="btn btn-sm btn-primary" ng-click="markOverduePaid()" ng-if="!reservations[0].overduePaid && reservations[0].status != 'CANCELED'">
          <span class="glyphicon glyphicon-ok"/>
          Mark overdue as paid
        </button>
        <button class="btn btn-sm btn-primary" ng-click="markOverdueUnpaid()" ng-if="reservations[0].overduePaid">
          <span class="glyphicon glyphicon-remove"/>
          Mark overdue as unpaid
        </button>
      </span>
    </div>
    <hr/>
  </div>

  <div class="col-md-3">
    <h4>Customer information</h4>
    <table class="table table-striped table-condensed">
      <tbody>
        <tr>
          <td>User Id</td>
          <td>{{reservations[0].customer.user.id}}</td>
        </tr>
        <tr>
          <td>First name</td>
          <td>{{reservations[0].customer.user.firstName}}
        </tr>
        <tr>
          <td>Last name</td>
          <td>{{reservations[0].customer.user.lastName}}
        </tr>
        <tr>
          <td>Email</td>
          <td>{{reservations[0].customer.user.email}}
        </tr>
        <tr>
          <td>Phone</td>
          <td>{{reservations[0].customer.user.phone}}
        </tr>
        <tr>
          <td>Address</td>
          <td>{{reservations[0].customer.address}}
        </tr>
        <tr>
          <td>Postal code</td>
          <td>{{reservations[0].customer.postalCode}}
        </tr>
        <tr>
          <td>Birth date</td>
          <td>{{reservations[0].customer.birthDate | date: 'medium'}}
        </tr>
      </tbody>
    </table>
  </div>
  <div class="col-md-3">
    <h4>Travel information</h4>
    <table class="table table-striped table-condensed">
      <tbody>
        <tr>
          <td>From</td>
          <td>{{reservations[0].startTime | date: 'medium'}}</td>
        </tr>
        <tr>
          <td>To</td>
          <td>{{reservations[0].endTime | date: 'medium'}}</td>
        </tr>
      </tbody>
    </table>
    <hr/>
    <div ng-if="reservations[0].assignedDriver">
      <h4>Driver required</h4>
      <table class="table table-striped table-condensed">
        <tbody>
          <tr>
            <td>First name</td>
            <td>{{reservations[0].assignedDriver.firstName}}</td>
          </tr>
          <tr>
            <td>Last name</td>
            <td>{{reservations[0].assignedDriver.lastName}}</td>
          </tr>
          <tr>
            <td>Email</td>
            <td>{{reservations[0].assignedDriver.email}}</td>
          </tr>
          <tr>
            <td>Phone</td>
            <td>{{reservations[0].assignedDriver.phone}}</td>
          </tr>
        </tbody>
      </table>
      <a class="btn btn-primary btn-sm" ng-href="{{parentUrl}}/users/agenda.jsf?userId={{reservations[0].assignedDriver.id}}">Check Agenda</a>
    </div>
  </div>
  <div class="col-md-3">
    <h4>Reserved inventories detail</h4>
    <ol>
      <li ng-repeat="reservation in reservations">
        <a ng-href="{{parentUrl}}/inventories/index.jsf#/{{reservation.inventory.owner.id}}/inventories/{{reservation.inventory.id}}/detail?entity={{reservation.inventory.type}}">{{reservation.inventory.name}}</a>

        <span class="label label-primary" ng-if="reservation.inventory.status == 'AVAILABLE'">{{reservation.inventory.status}}</span>
        <span class="label label-success" ng-if="reservation.inventory.status == 'RENTED'">{{reservation.inventory.status}}</span>
        <span class="label label-danger" ng-if="reservation.inventory.status == 'BROKEN'">{{reservation.inventory.status}}</span>
        <span class="label label-default" ng-if="reservation.inventory.status == 'DELETED'">{{reservation.inventory.status}}</span>
        <span class="label label-warning" ng-if="reservation.inventory.status == 'RETURNED'">{{reservation.inventory.status}}</span>
      </li>
    </ol>
  </div>
  <div class="col-md-3">
    <h4>Price breakdown</h4>
    <table class="table table-condensed table-striped">
      <thead>
        <tr>
          <th>Name</th>
          <th>Price</th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="reservation in reservations">
          <td>{{reservation.inventory.name}}</td>
          <td align="right">{{selectedBranch.currencySymbol}} {{reservation.inventoryFee}}</td>
        </tr>
        <tr ng-if="reservations[0].assignedDriver">
          <td>Driver</td>
          <td align="right">{{selectedBranch.currencySymbol}} {{reservations[0].driverFee}}</td>
        </tr>
      </tbody>
      <tfoot>
        <tr>
          <td><b>Total</b></td>
          <td align="right"><b>{{selectedBranch.currencySymbol}} {{totalPrice(reservations)}}</b></td>
        </tr>
      </tfoot>
    </table>
  </div>
</div>
<div class="row">
  <div class="col col-md-6">
    <h4>Location</h4>
    <div id="map-canvas"></div>
  </div>
</div>